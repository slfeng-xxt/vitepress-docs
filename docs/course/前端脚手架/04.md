# Lerna简介

:::tip
Lerna 是一个快速、领先的构建系统，用于管理和发布来 自同一源码仓库的多个 JavaScript/TypeScript 软件包
:::

## 解决痛点：package越多，管理复杂度越高

例如：babel,有几十个包需要管理

### 1.重复操作

* 多package本地link
* 多package依赖安装
* 多package单元测试
* 多package代码提交
* 多package代码发布

### 2.版本一致性

* 发布时版本一致
* 发布后相互依赖版本升级

### 优势

* 大幅减少重复操作
* 提升操作的标准化

lerna是架构优化的产物，它说明了一个架构真理：当项目复杂度提升后，就要对项目进行架构优化。
架构优化的主要目标通常都是以**效能**为核心

## 案例

* [babel](https://github.com/babel/babel)
* [vue-cli](https://github.com/vuejs/vue-cli)
* [create-react-app](https://github.com/facebook/create-react-app)

## Lerna开发脚手架流程

### 1.脚手架项目初始化

* 初始化npm 项目
* 安装 lerna
* lerna init初始化项目（重点）

### 2.创建package

* lerna create [name] 创建Package（重点）
* lerna add `<package>`安装依赖
* lerna link 链接依赖

### 3.脚手架开发和测试

* lerna exec -- `<commond>` 执行shell脚本
* lerna run 执行npm命令（重点）
* lerna clean 清空依赖
* lerna bootstap 重装依赖

### 4.脚手架发布上线

* lerna version / bump version
* lerna changed 查看版本所有的变更
* lerna diff 查看diff
* lerna publish 项目发布（重点）

## Lerna源码分析

### 目标

* 源码结构、执行流程分析
* import-local源码精读

### 收获（基础条件：熟练NodeJs）

* 明星项目架构设计
* 脚手架执行流程的一种实现思路
* 脚手架调试本地源码的另外一种方法
* Node.js加载node_modules模块的流程
* 各种文件操作算法和最佳实践

### 源码准备(Tag-3.0.0)

* deskTop/vue-ts/framework/lerna
* node-v12.11.1
* 找到入口文件 core/lerna/cli.js
* 能够本地调试（webstorm配置debuger启动）

### 源码结构【todo】
