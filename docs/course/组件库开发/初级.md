# 初级篇

:::warning
重点：

1. 组件库、通用库架构设计

2. 组件库方案选型和细节设计实现

3. 组件库构建发布和持续迭代

:::

:::tip
开发过组件库吗，设计和开发思路是什么？

一、架构设计：分层、解耦、响应式设计

二、组件库状态管理 ：全局状态管理、局部状态管理

三、组件库样式方案和主题设计：Color Token 规范、样式模块化方案、样式优先级与覆盖

四、模块设计：可复用模块、公共方法
:::

## 1. 样式体系构建(前提条件)

### 1.1 颜色 token 规范

- 一般情况是每种颜色划分为 10 个等级，--blue-0,--blue-1,...--blue-10
- shadow 划分：--shadow-0,--shadow-1,...--shadow-10

### 1.2 字体 token 规范

- 字体大小划分：--font-size-12,--font-size-14,...--font-size-20
- 字体粗细划分：--font-weight-100,--font-weight-200,...--font-weight-900

### 1.3 布局 token 规范

- 布局划分：--padding-0,--padding-1,...--padding-10
- 布局划分：--margin-0,--margin-1,...--margin-10

### 1.4 组件 token 规范

- 组件划分：--button-size-large,--button-size-small

### 1.5 主题 token 规范

- 主题划分：--theme-dark,--theme-light

## 2. 组件库架构设计

### 2.1 总体架构设计

#### 分层

- rc-xxx, 提供基础组件，unstyled-components(headless), 只具备功能的交互，不具备 UI 样式
- 样式体系，提供 UI 样式
- 基础组件
- 复合组件：基于基础组件，提供更高级的组件（eg: search = input + select + button）
- 业务组件: 特定业务场景下，基于基础组件和复合组件，提供更高级的组件（eg: search = input + select + button + icon）

#### 解耦

- 对于每个组件都需要定义样式、TS 类型、基础操作、工具方法、事件处理、动画效果等，这些内容是耦合在一起的，需要解耦

#### 响应式设计

响应式设计：针对不同屏幕尺寸，提供不同的样式，实现响应式布局

- 媒体查询：针对不同屏幕尺寸，提供不同的样式。media query / ResizeObserver / Grid layout

### 2.2 组件库状态管理

#### 全局状态管理如：主题切换、国际化、基础配置等

- react: context(context 是 React 16 中引入的一个 API，用于在组件树中传递数据，而无需在每个组件中手动传递 props)/
    useSyncExternalStore(useSyncExternalStore 是 React 18 中引入的一个 Hook，用于订阅外部 store 并在 store 发生变化时触发组件更新。)
- vue: vue-demi（vue-demi是 vue2和 vue3的兼容层，可以同时支持 vue2和 vue3）

#### 局部状态管理如：表单、弹窗、下拉菜单等

- 表单： 受控组件、非受控组件（状态是否和表单值双向奔赴）

```txt
受控组件举例：
<input type="text" value={value} onChange={onChange} />
非受控组件举例：
<input type="text" />
```

### 2.3 组件库样式方案和主题设计

- Color Token 规范：颜色色值系统。有如下几种方案：

```txt
css in js: ant-design、arco
重写样式：mantineUI、mui
下载到本地随意修改：tailwindcss、shadcn/ui
```

- 样式模块化方案： css-in-js（弊端：运行时、SSR支持方面）【emotion、style-components】、 module css

- 样式优先级与覆盖： 控制样式优先级，防止样式覆盖

拓展：

- [css in js](https://zhuanlan.zhihu.com/p/30653936679)
- [在 React 项目中使用 Emotion （CSS in JS）](https://juejin.cn/post/6972160798466506788)
- [mantineUI](https://mantine.dev/)
- [shadcn/ui](https://www.shadcn.com.cn/docs)
- [全面解读 ShadCN UI：揭秘复制粘贴的组件库如何重新定义开发体验](https://juejin.cn/post/7459710889064906767)

## 3. 模块设计

### 3.1 可复用模块

对于props、events的处理很重要

### 3.2 公共方法

对于公共方法，可以放在 utils 文件夹中，如：debounce、throttle、request、storage 等

## 4. 开发流程

### 4.1 本地开发（antd的二次开发）

### 4.2 组件库的开发流程

- 1.工程架构： **monorepo**、lerna、pnpm。（分包：core + components + hooks + utils + shared）***TODO: 地图组件库的开发***
- 2.TypeScript
- 3.构建打包：rollup esbuild swc
- 4.测试：单元测试、组件测试、e2e测试，vitest、jest、cypress
- 5.流程化（CI/CD）、规范化（eslint9/stylelint/commitlint）、自动化(颜色值生成、自动构建、增量构建、构建缓存)

## 5. 性能优化

## 6. 文档和用户支持
