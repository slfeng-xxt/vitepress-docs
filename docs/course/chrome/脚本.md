# 脚本练习

## 1. YouTube 自动点赞脚本

```js
// ==UserScript==
// @name         YouTube自动点赞脚本
// @namespace    http://tampermonkey.net/
// @version      1.0
// @description  在YouTube视频播放10秒后自动点赞
// @author       You
// @match        https://www.youtube.com/watch*
// @grant        none
// ==/UserScript==

(function () {
  "use strict";

  let hasLiked = false; // 防止重复点赞
  let videoStartTime = 0;

  function autoLike() {
    // 查找点赞按钮
    const likeButton = document.querySelector(
      "#top-level-buttons-computed > segmented-like-dislike-button-view-model > yt-smartimation > div > div > like-button-view-model > toggle-button-view-model > button"
    );

    if (likeButton && !hasLiked) {
      // 检查是否已经点赞（按钮是否处于激活状态）
      const isAlreadyLiked = likeButton.getAttribute("aria-pressed") === "true";

      if (!isAlreadyLiked) {
        likeButton.click();
        hasLiked = true;
        console.log("已自动点赞！");
      } else {
        console.log("视频已经点过赞了");
        hasLiked = true;
      }
    }
  }

  function checkVideoTime() {
    const video = document.querySelector("video");
    if (video && !hasLiked) {
      const currentTime = video.currentTime;

      // 如果视频播放时间超过10秒，执行点赞
      if (currentTime >= 10) {
        autoLike();
      }
    }
  }

  function resetLikeStatus() {
    hasLiked = false;
    console.log("重置点赞状态，准备监控新视频");
  }

  function initScript() {
    // 监听URL变化（YouTube是单页应用）
    let currentUrl = window.location.href;

    // 重置状态
    resetLikeStatus();

    // 等待视频元素加载
    const waitForVideo = setInterval(() => {
      const video = document.querySelector("video");
      if (video) {
        clearInterval(waitForVideo);

        // 监听视频时间变化
        video.addEventListener("timeupdate", checkVideoTime);

        console.log("YouTube自动点赞脚本已启动，将在视频播放10秒后自动点赞");
      }
    }, 1000);

    // 监听页面变化
    const observer = new MutationObserver(() => {
      if (currentUrl !== window.location.href) {
        currentUrl = window.location.href;
        resetLikeStatus();

        // 重新初始化视频监听
        setTimeout(() => {
          const video = document.querySelector("video");
          if (video) {
            video.addEventListener("timeupdate", checkVideoTime);
          }
        }, 2000);
      }
    });

    observer.observe(document, { childList: true, subtree: true });
  }

  // 页面加载完成后启动脚本
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initScript);
  } else {
    initScript();
  }
})();
```
