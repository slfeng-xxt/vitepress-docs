# 打包工具

## 1. 构建工具发展史

```txt
1. 2009 年，Kevin Dangoor 发起了 ServerJS 项目，后更名为 CommonJS，其目标是指定浏览器外的 JS API 规范（例如 FS、Stream、Buffer 等）以及模块规范 Modules/1.0。这一规范也成为同年发布的 NodeJS 中的模块定义的参照规范；
2. 2011 年，RequireJS 1.0 版本发布，作为客户端的模块加载器，提供了异步加载模块的能力。作者在之后提交了 CommonJS 的 Module/Transfer/C 提案，这一提案最终发展为了独立的 AMD 规范；
3. 2013 年，Grunt、Gulp第一版相继发布，同年，面向浏览器端模块的打包工具Browserify发布；
4. 2014 年，跨平台的前后端兼容的模块化定义语法 UMD发布；
5. 2014 年，Sebastian McKenzie 发布了将 ES6 语法转换为 ES5 语法的工具 6to5，并在之后更名为Babel；
6. 2014 年，Guy Bedford 对外发布了 SystemJS 和 jspm 工具，用于简化模块加载和处理包管理；
7. 2014 年，打包工具 Webpack 发布了第一个稳定版本；
8. 2015 年，ES6（ES2015）规范正式发布，第一次从语言规范上定义了 JS 中的模块化；
9. 2015 年，Rich Harris 发布的 Rollup 项目，基于 ES6 模块化，提供了 Tree Shaking 的功能；
10. 2017年，鉴于当时的Webpack使用上过于繁琐，官方文档也不是很清晰明了。所以Parcel一发布就被推上了风口浪尖；
11. 2019年，snowpack将node_modules转为ESM的构建工具开始出现；
12. 2020年，随着浏览器对ESM和HTTP2的支持，bundleless思路也开始出现，esbuild此时开始出现在视野里，同时snowpack也开始内置使用esbuild；
13. 2021年，Vite出现；
```

1. 初版构建工具--Grunt、Gulp；
2. 现代打包构建工具基石--webpack；
3. 基于webpack改进的构建工具 -- Parcel；
4. 突破JS语言特性的构建工具 -- esbuild、snowpack、vite；
5. 基于ES Module的bundleless构建工具 -- vite；

## 2. 常见打包工具

### 2.1 Grunt

介绍：基于任务的自动化构建工具，通过配置文件定义一系列任务，并指定任务之间的依赖关系，最终由 Grunt 执行这些任务。

特点：

- 配置驱动：通过配置文件定义任务和依赖关系；
- 插件丰富：拥有丰富的插件，可以完成各种构建任务；
- 适用于小到中型的项目；

### 2.2 Gulp

介绍：基于流的自动化构建工具，通过定义一系列的“任务”（task），使用插件来处理文件流，最终输出到目标目录。

特点：

- 流式处理：通过管道（pipe）的方式处理文件流，提高构建效率；
- 插件丰富：拥有丰富的插件，可以完成各种构建任务；
- 适用于小到中型的项目；

### 2.3 Webpack（基石）

介绍：模块打包工具，可以将项目中的各种资源（JavaScript、CSS、图片等）打包成一个或多个文件，支持模块化、代码分割、按需加载等功能。

特点：

- 模块化：支持 ES6 模块、CommonJS 模块等多种模块化规范；
- 代码分割：可以将代码分割成多个文件，按需加载，提高页面加载速度；
- 按需加载：支持按需加载模块，减少首次加载时间；
- 插件丰富：拥有丰富的插件，可以完成各种构建任务；
- 适用于大型项目；

### 2.4 Rollup

介绍：模块打包工具，专注于 JavaScript 库的打包，支持 Tree Shaking，可以将代码打包成更小的体积。

特点：

- Tree Shaking：支持 Tree Shaking，可以去除未使用的代码，减小打包体积；
- 模块化：支持 ES6 模块、CommonJS 模块等多种模块化规范；
- 适用于 JavaScript 库的打包；

### 2.5 Parcel

介绍：零配置的打包工具，可以快速构建项目，支持多种文件类型，无需配置。

特点：

- 零配置：无需配置文件，即可快速构建项目；
- 多文件类型支持：支持多种文件类型，如 HTML、CSS、JavaScript、图片等；
- 快速构建：使用多核并行处理，提高构建速度；
- 适用于小型到中型的项目；

### 2.6 esbuild

介绍：基于 Go 语言开发的打包工具，具有极快的构建速度和更小的打包体积。

特点：

- 极快的构建速度：使用 Go 语言开发，构建速度比其他打包工具快很多倍；
- 更小的打包体积：支持 Tree Shaking，可以去除未使用的代码，减小打包体积；
- 支持多种文件类型：支持 JavaScript、CSS、图片等文件类型；
- 适用于大型项目；

### 2.7 Snowpack

介绍：基于 ES Module 的打包工具，**无需打包**即可实现模块化开发，支持热更新。

特点：

- 模块化开发：无需打包即可实现模块化开发，提高开发效率；
- 热更新：支持热更新，无需重新加载页面即可看到更新效果；
- 支持多种文件类型：支持 JavaScript、CSS、图片等文件类型；

### 2.8 Vite（下一代构建工具，bundleless）

介绍：基于 ES Module 的打包工具，**无需打包**即可实现模块化开发，支持热更新。

特点：

- 模块化开发：无需打包即可实现模块化开发，提高开发效率；
- 热更新：支持热更新，无需重新加载页面即可看到更新效果；
- 支持多种文件类型：支持 JavaScript、CSS、图片等文件类型；
- 极快的构建速度：使用原生 ES Module，无需打包即可实现模块化开发，提高开发效率；
- 适用于大型项目；

### 2.9 TurboPack(基于Rust的下一代Webpack)

介绍：基于 Webpack 的构建工具，提供了一些优化和增强功能，如代码分割、按需加载、Tree Shaking 等。

特点：

- 优化和增强：提供了一些优化和增强功能，如代码分割、按需加载、Tree Shaking 等；
- 插件丰富：拥有丰富的插件，可以完成各种构建任务；
- 适用于大型项目；

## 3. 常见构建工具对比

| 特性         | Grunt | Gulp | Webpack | Rollup | Parcel | esbuild | Snowpack | Vite | TurboPack |
| ------------ | ----- | ---- | ------- | ------ | ------ | ------- | -------- | ---- | --------- |
| 配置驱动     | 是    | 是   | 是      | 是     | 否     | 否      | 否       | 否   | 是        |
| 流式处理     | 否    | 是   | 否      | 否     | 否     | 否      | 是       | 是   | 是        |
| 模块化       | 是    | 是   | 是      | 是     | 是     | 是      | 是       | 是   | 是        |
| 代码分割     | 否    | 否   | 是      | 是     | 是     | 是      | 是       | 是   | 是        |
| 按需加载     | 否    | 否   | 是      | 是     | 是     | 是      | 是       | 是   | 是        |
| Tree Shaking | 否    | 否   | 是      | 是     | 是     | 是      | 是       | 是   | 是        |
| 插件丰富     | 是    | 是   | 是      | 是     | 是     | 是      | 是       | 是   | 是        |
| 构建速度     | 慢    | 快   | 中      | 快     | 快     | 非常快  | 快       | 非常快 | 非常快    |
| 适用于项目   | 小到中 | 小到中 | 大      | 大     | 小到中 | 大      | 小到中   | 大   | 大        |
